<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TREP Mini App</title>
    <!-- Tailwind CSS CDN for easy styling and responsiveness -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for Inter font and general body setup */
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--tg-theme-bg-color, #FF8C69); /* Fallback background set to pink-orange */
            color: var(--tg-theme-text-color, white); /* Fallback text color for contrast */
            transition: background-color 0.3s ease, color 0.3s ease; /* Smooth theme transitions */
        }
        /* Specific styles for tab buttons to handle active/inactive states */
        .tab-button.active {
            background-color: var(--tg-theme-button-color, #ADD8E6) !important; /* Active tab changed to very light blue */
            color: var(--tg-theme-button-text-color, black) !important; /* Active tab text changed to black for contrast */
        }
        /* Default styles for tab buttons, overridden by inline styles for specific colors */
        .tab-button:not(.active) {
            color: var(--tg-theme-text-color, #333) !important;
        }
        /* Onboarding screen styles */
        .onboarding-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--tg-theme-bg-color, #f0f2f5); /* Use Telegram background color */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000; /* Ensure it's on top */
            flex-direction: column;
            padding: 1rem;
            text-align: center;
        }
        .onboarding-content {
            background: var(--tg-theme-secondary-bg-color, white);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            max-width: 90%;
            width: 500px;
            color: var(--tg-theme-text-color, #333);
        }
        .onboarding-button {
            background-color: var(--tg-theme-button-color, #0088cc);
            color: var(--tg-theme-button-text-color, white);
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s ease;
            margin-top: 1.5rem;
        }
        .onboarding-button:hover {
            filter: brightness(90%);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <!-- Onboarding Screen -->
    <div id="onboardingScreen" class="onboarding-overlay hidden">
        <div class="onboarding-content">
            <img src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/logo.png?raw=true" alt="TREP App Logo" class="w-24 h-24 rounded-full mb-4 object-cover mx-auto">
            <h2 class="text-2xl font-bold mb-3" style="color: var(--tg-theme-link-color, #0088cc);">Welcome to TREP Mini App!</h2>
            <p class="mb-6" style="color: var(--tg-theme-text-color, #333);">
                Your ultimate companion for exclusive deals, real-time market insights, and community connections within the TREP ecosystem.
            </p>
            <button id="startJourneyButton" class="onboarding-button">
                Start Your Journey
            </button>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="bg-white dark:bg-gray-800 rounded-xl shadow-lg p-6 w-full max-w-2xl flex flex-col items-center hidden"
         id="app-container"
         style="background-color: lightgreen !important;"> <!-- Main container background set to lightgreen with !important -->

        <!-- Logo -->
        <img id="appLogo" src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/logo.png?raw=true" alt="TREP App Logo" class="w-24 h-24 rounded-full mb-4 object-cover">

        <!-- Welcome Message -->
        <h1 class="text-3xl font-bold mb-3 text-center"
            style="color: var(--tg-theme-link-color, #0088cc);">
            Welcome to TREP Mini App!
        </h1>
        <p class="text-center mb-6" style="color: var(--tg-theme-text-color, #333);">
            Your gateway to exclusive deals, real-time stats, and community access.
        </p>

        <!-- Tab Navigation -->
        <div class="flex justify-center flex-wrap mb-6 w-full space-x-2">
            <button id="overviewTabButton" class="tab-button px-4 py-2 rounded-lg font-semibold text-sm transition-colors duration-200"
                    style="background-color: lightblue;">
                Overview
            </button>
            <button id="statsTabButton" class="tab-button px-4 py-2 rounded-lg font-semibold text-sm transition-colors duration-200"
                    style="background-color: lightblue;">
                Trenks
            </button>
            <button id="dealsTabButton" class="tab-button px-4 py-2 rounded-lg font-semibold text-sm transition-colors duration-200"
                    style="background-color: lightblue;">
                Deals
            </button>
            <button id="accessTabButton" class="tab-button px-4 py-2 rounded-lg font-semibold text-sm transition-colors duration-200"
                    style="background-color: lightblue;">
                Access
            </button>
        </div>

        <!-- Tab Content: Overview -->
        <div id="overviewTabContent" class="tab-content w-full hidden">
            <h2 class="text-2xl font-bold mb-4" style="color: var(--tg-theme-link-color, #0088cc);">Overview</h2>
            <p class="mb-4" style="color: var(--tg-theme-text-color, #333);">
                TREP is a community-powered token with real utility in Deal Discovery and Market Signals. Stake TREP to access early listings, investor analytics, and premium dashboards. Powered by bots, data, and a loyal Telegram community â€” join the future of alpha hunting.
                <br><br>Join our community!
            </p>
            <img src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/Overview.png?raw=true" alt="TREP Ecosystem Overview" class="w-64 h-auto rounded-lg mb-4 object-cover block mx-auto">
            <p class="text-sm" style="color: var(--tg-theme-hint-color, #666);">
                Learn more about our mission and features.
            </p>
        </div>

        <!-- Tab Content: Trenks (formerly Real-time Stats) -->
        <div id="statsTabContent" class="tab-content w-full hidden">
            <h2 class="text-2xl font-bold mb-4" style="color: var(--tg-theme-link-color, #0088cc);">Trenks</h2>
            <p class="mb-4" style="color: var(--tg-theme-text-color, #333);">
                Here you will find important links related to TREP tokens, community, and social media.
            </p>
            <div id="statsDisplay" class="bg-gray-100 p-4 rounded-lg text-left flex flex-wrap justify-center items-start gap-4" style="background-color: var(--tg-theme-bg-color, #f9f9f9); color: var(--tg-theme-text-color, #333);">
                <div class="flex-1 min-w-[200px]">
                    <p><strong>Check TREP on:</strong></p>
                    <ul class="list-disc list-inside ml-4 mb-4">
                        <li><a href="https://dexscreener.com/solana/a6fmyrfluwn8xvfsnyqtsd2kpxht2b4lq4l8lkp11nnm" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">Dexscreener</a></li>
                        <li><a href="https://www.geckoterminal.com/solana/pools/A6FMyRFLuwN8xvFSNYqtsd2KPxht2B4LQ4L8LkP11NnM?utm_source=coingecko&utm_medium=referral&utm_campaign=searchresults" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">GeckoTerminal (CoinGecko)</a></li>
                        <li><a href="https://www.dextools.io/app/en/solana/pair-explorer/A6FMyRFLuwN8xvFSNYqtsd2KPxht2B4LQ4L8LkP11NnM?t=1753065837128" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">Dextools</a></li>
                        <li><a href="https://solscan.io/token/Cf7r9JE9HcHSe1EN3hm6kEjGCyQuV3p6CjuwRx919Tka" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">Solscan</a></li>
                    </ul>

                    <p><strong>Join our Socials:</strong></p>
                    <ul class="list-disc list-inside ml-4 mb-4">
                        <li><a href="https://www.youtube.com/@Intrepid-TREPofficial" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">YouTube</a></li>
                        <li><a href="https://x.com/OffcialTrep" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">X (Twitter)</a></li>
                    </ul>
                    <p><strong>Official Website:</strong></p>
                    <ul class="list-disc list-inside ml-4">
                        <li><a href="https://sites.google.com/view/intrepid-trep/home" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">Intrepid TREP Website</a></li>
                    </ul>
                </div>
                <img src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/Real-time%20stats.png?raw=true" alt="Trenks Visual" class="w-64 h-auto rounded-lg my-2 object-cover">
            </div>
        </div>

        <!-- Tab Content: Deals -->
        <div id="dealsTabContent" class="tab-content w-full hidden">
            <h2 class="text-2xl font-bold mb-4" style="color: var(--tg-theme-link-color, #0088cc);">Public Deals</h2>
            <p class="mb-4" style="color: var(--tg-theme-text-color, #333);">
                Exclusive Discount on Tech Gadgets and more.
            </p>
            <div class="deal-item bg-gray-100 p-4 rounded-lg mb-3" style="background-color: var(--tg-theme-bg-color, #f9f9f9); color: var(--tg-theme-text-color, #333);">
                <h3 class="font-semibold text-lg">Deal: Exclusive Discount on Tech Gadgets</h3>
                <p class="text-sm">Get 20% off on selected electronics for a limited time!</p>
                <img src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/Unlock%20exclusive%20deals.png?raw=true" alt="Unlock Exclusive Deals" class="w-64 h-auto rounded-lg my-2 object-cover block mx-auto">
                <a href="https://example.com/public-deal-finder" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">
                    Visit Public Deal Finder
                </a>
            </div>
            <div class="deal-item bg-gray-100 p-4 rounded-lg" style="background-color: var(--tg-theme-bg-color, #f9f9f9); color: var(--tg-theme-text-color, #333);">
                <h3 class="font-semibold text-lg">Community Channel: Intrepid Public</h3>
                <p class="text-sm">Join our public channel for updates and discussions.</p>
                <a href="https://t.me/intrepid_public_channel" target="_blank" class="text-blue-500 hover:underline" style="color: var(--tg-theme-link-color, #0088cc);">
                    Join Intrepid Public Channel
                </a>
            </div>
        </div>

        <!-- Tab Content: Access -->
        <div id="accessTabContent" class="tab-content w-full hidden">
            <h2 class="text-2xl font-bold mb-4" style="color: var(--tg-theme-link-color, #0088cc);">Gain Full Access</h2>
            <p class="mb-4" style="color: var(--tg-theme-text-color, #333);">
                Gain lifetime access to the 'TREP Deal Finder - Full Access' channel by burning 100,000 $TREP tokens. You'll find exclusive deals, clothes, gadgets, oils & remedies, PDFs, news, videos, music, and much more.
            </p>
            <p class="mb-4" style="color: var(--tg-theme-text-color, #333);">
                Connect your Solana wallet to proceed with payment.
            </p>
            <div class="bg-gray-100 p-4 rounded-lg mb-4 text-left" style="background-color: var(--tg-theme-bg-color, #f9f9f9); color: var(--tg-theme-text-color, #333);">
                <h3 class="font-semibold text-lg" style="color: var(--tg-theme-link-color, #0088cc);">Early Holder Access</h3>
                <p class="text-sm">Your gateway to token insights, community tools, and exclusive access.</p>
            </div>
            <img src="https://github.com/AllanTREP/my-telegram-mini-app/blob/main/Access%20tab.png?raw=true" alt="Access Tab Visual" class="w-64 h-auto rounded-lg mb-4 object-cover block mx-auto">
            <button id="connectWalletButton"
                    class="w-full py-3 rounded-lg font-bold text-white transition-colors duration-200 mb-4"
                    style="background-color: purple !important; color: white !important;"> <!-- Connect Wallet button color changed to purple with !important -->
                Connect Wallet & Burn 100,000 TREP
            </button>
            <p id="walletStatus" class="text-sm text-center" style="color: var(--tg-theme-hint-color, #666);">
                Wallet not connected.
            </p>
            <p class="text-xs mt-4" style="color: var(--tg-theme-hint-color, #666);">
                (Note: Wallet connection and token burning require integration with a blockchain library and a smart contract.)
            </p>
        </div>

        <!-- General Info Text at the bottom of the main container -->
        <p id="infoText" class="mt-6 text-sm text-gray-600 text-center w-full"
           style="color: var(--tg-theme-hint-color, #666);">
            Hello, User!
        </p>

    </div>

    <!-- Telegram Mini Apps SDK Script -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <script>
        Telegram.WebApp.ready();

        // Get references to elements
        const onboardingScreen = document.getElementById('onboardingScreen');
        const startJourneyButton = document.getElementById('startJourneyButton');
        const appContainer = document.getElementById('app-container');
        const infoText = document.getElementById('infoText');
        const walletStatus = document.getElementById('walletStatus');

        // Tab Buttons
        const overviewTabButton = document.getElementById('overviewTabButton');
        const statsTabButton = document.getElementById('statsTabButton'); // Now Trenks
        const dealsTabButton = document.getElementById('dealsTabButton');
        const accessTabButton = document.getElementById('accessTabButton');

        // Tab Contents
        const overviewTabContent = document.getElementById('overviewTabContent');
        const statsTabContent = document.getElementById('statsTabContent'); // Now Trenks content
        const dealsTabContent = document.getElementById('dealsTabContent');
        const accessTabContent = document.getElementById('accessTabContent');

        // --- Onboarding Logic ---
        function checkOnboardingStatus() {
            const onboardingComplete = localStorage.getItem('onboarding_complete');
            if (onboardingComplete === 'true') {
                onboardingScreen.classList.add('hidden');
                appContainer.classList.remove('hidden');
                showTab('overviewTabContent'); // Show default tab after onboarding
            } else {
                onboardingScreen.classList.remove('hidden');
                appContainer.classList.add('hidden');
            }
        }

        startJourneyButton.onclick = function() {
            localStorage.setItem('onboarding_complete', 'true');
            onboardingScreen.classList.add('hidden');
            appContainer.classList.remove('hidden');
            showTab('overviewTabContent'); // Show default tab after onboarding
        };

        // --- Tab Switching Logic ---
        function showTab(tabId) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.add('hidden');
            });
            // Remove active class from all tab buttons
            document.querySelectorAll('.tab-button').forEach(button => {
                button.classList.remove('active');
            });

            // Show the selected tab content
            document.getElementById(tabId).classList.remove('hidden');

            // Add active class to the corresponding tab button
            const activeButton = document.getElementById(tabId.replace('Content', 'Button'));
            if (activeButton) {
                activeButton.classList.add('active');
            }
        }

        // Event listeners for tab buttons
        overviewTabButton.onclick = () => showTab('overviewTabContent');
        statsTabButton.onclick = () => showTab('statsTabContent');
        dealsTabButton.onclick = () => showTab('dealsTabContent');
        accessTabButton.onclick = () => showTab('accessTabContent');

        // --- Main Button (still active globally) ---
        Telegram.WebApp.MainButton.setText("Press Me: Main Button!");
        Telegram.WebApp.MainButton.show();
        Telegram.WebApp.MainButton.onClick(function() {
            console.log('Main Button was clicked!');
            Telegram.WebApp.sendData('main_button_pressed');
            infoText.innerText = 'Main Button pressed! Data sent to bot.';
        });

        // --- Display User Data ---
        if (Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.user) {
            const user = Telegram.WebApp.initDataUnsafe.user;
            infoText.innerHTML = `Hello, ${user.first_name || 'User'}!`;
            if (user.language_code) {
                infoText.innerHTML += `<br>Your language: ${user.language_code}`;
            }
        } else {
            infoText.innerHTML += `<br>User data not available for display.`;
        }

        // --- Wallet Connection Logic (Placeholder in Access tab) ---
        const connectWalletButton = document.getElementById('connectWalletButton');
        if (connectWalletButton) {
            connectWalletButton.onclick = function() {
                console.log('Connect Wallet button clicked. (Functionality not implemented yet)');
                if (walletStatus) {
                    walletStatus.innerText = 'Attempting to connect wallet... (Placeholder)';
                }
            };
        }

        // Adapt to Telegram's Theme
        Telegram.WebApp.onEvent('themeChanged', function() {
            document.documentElement.style.setProperty('--tg-theme-bg-color', Telegram.WebApp.themeParams.bg_color);
            document.documentElement.style.setProperty('--tg-theme-text-color', Telegram.WebApp.themeParams.text_color);
            document.documentElement.style.setProperty('--tg-theme-hint-color', Telegram.WebApp.themeParams.hint_color);
            document.documentElement.style.setProperty('--tg-theme-link-color', Telegram.WebApp.themeParams.link_color);
            document.documentElement.style.setProperty('--tg-theme-button-color', Telegram.WebApp.themeParams.button_color);
            document.documentElement.style.setProperty('--tg-theme-button-text-color', Telegram.WebApp.themeParams.button_text_color);
            document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', Telegram.WebApp.themeParams.secondary_bg_color);
        });
        // Apply theme on load
        if (Telegram.WebApp.themeParams) {
            document.documentElement.style.setProperty('--tg-theme-bg-color', Telegram.WebApp.themeParams.bg_color);
            document.documentElement.style.setProperty('--tg-theme-text-color', Telegram.WebApp.themeParams.text_color);
            document.documentElement.style.setProperty('--tg-theme-hint-color', Telegram.WebApp.themeParams.hint_color);
            document.documentElement.style.setProperty('--tg-theme-link-color', Telegram.WebApp.themeParams.link_color);
            document.documentElement.style.setProperty('--tg-theme-button-color', Telegram.WebApp.themeParams.button_color);
            document.documentElement.style.setProperty('--tg-theme-button-text-color', Telegram.WebApp.themeParams.button_text_color);
            document.documentElement.style.setProperty('--tg-theme-secondary-bg-color', Telegram.WebApp.themeParams.secondary_bg_color);
        }

        // Initial check for onboarding status when the script loads
        checkOnboardingStatus();
    </script>
</body>
</html>
